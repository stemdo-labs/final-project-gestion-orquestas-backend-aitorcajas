name: CI-CD backend

on:
  workflow_dispatch:
  push:
    branches:
    - main

jobs:
  environment:
    uses: stemdo-labs/final-project-exercise-aitorcajas/.github/workflows/environment.yml@main

  ci:
    needs: environment
    uses: stemdo-labs/final-project-exercise-aitorcajas/.github/workflows/ci.yml@main
    with:
      entorno: ${{ needs.environment.outputs.entorno }}
    secrets: inherit

  cd:
    needs: ci
    uses: stemdo-labs/final-project-exercise-aitorcajas/.github/workflows/cd.yml@main
    with:
      desarrollo: ${{ needs.ci.outputs.desarrollo }}
    secrets: inherit